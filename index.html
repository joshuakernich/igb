<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>IGB Prototypes</title>
	<script type="text/javascript" src="./shared/jq.js"></script>
	<script type="text/javascript">
		$(function () {
			const proto = {
				
				'FIL JUMP':'fil/jump.html',
				'LOS MAZE':'./los/maze-nav.html',
				'QUIZ':"I Don't Know Much/index.html",
				'BRIDGE':"https://joshuakernich.github.io/the-bridge/",
			}

			for(var p in proto){
				$('<li>').appendTo('.menu-games').text(p).attr('url',proto[p]).click(launchProto);
			}

			function launchProto() {
				let url = $(this).attr('url');
				$('iframe').attr('src',url).addClass('active');
			}

			$('[btn=move]').click(function() {
				
			})

			$('[btn=menu]').click(function() {
				$('iframe').removeClass('active').attr('src','');

			})

			let log = [];
			let players = [];
			while(players.length<6){
				players.push({x:0,y:0,z:0});
				$('<player>').appendTo('tracker');
			}

			doLog('Vuplex is '+(window.vuplex?'ready':'not ready'));
		
			if (window.vuplex) {
			    ready();
			} else {
			    window.addEventListener('vuplexready', ready);
			}

			function ready(){
				doLog("Let's go...");
				window.vuplex.postMessage({ type: 'greeting', message: 'Hello from JavaScript!' });
			  	window.vuplex.addEventListener('message', function(e) { onMessage(e.data) });
			}

			function onMessage(str){
				

		        let arr = str.split(' ');
		        let type = arr[0];

		        if(type=='M'){
		        	let p = arr[1];
		        	players[p].x = arr[2];
		        	players[p].y = arr[3];
		        	players[p].z = arr[4];
		        	
		        	let px = (players[p].x+1)/2*100;
		        	let py = (players[p].y+1)/2*100;

		        	$('player').eq(p).css({left:px+'%',top:py+'%'});
		        	
		        	//$('iframe').window.postMessage(players);
		        }

		        doLog(str);

		        //doLog(str);
			}

			function doLog( ...args ){
				log.unshift( args.join(' ') );
			  	if(log.length>10) log.length = 10;
			    $('logger').html(log.join('<br>'));
			}

			

			$(document).click(function(e){
				$('<dot type=red>').appendTo('body').css({left:e.pageX,top:e.pageY}).animate({width:150,height:150,opacity:0},500,function(){
					$(this).remove();
				});
			})

			onMessage('M,0,0,0,0');

		})
	</script>
	<style type="text/css">
		@import url('https://fonts.googleapis.com/css2?family=DotGothic16&family=PT+Sans+Narrow:wght@400;700&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap');

		body{
			background: #333;
			--igb-purple: #330357;
   			--igb-pink: #FF00B7;

   			font-family: "Rubik", sans-serif;
		  font-optical-sizing: auto;
		  font-weight: 300;
		  font-style: bold;
		  font-size: 30px;

   			background: var(--igb-purple);
		}

		dot{
			position: fixed;
			width: 20px;
			height: 20px;
			
			transform: translate(-50%,-50%);
			background: radial-gradient(transparent, transparent, white, transparent, transparent);
			border-radius: 100px;
		}

		dot[type="blue"]{
			background: blue;
		}

		
		logger{
			
			display: block;
			
			font-family: sans-serif;
			margin: 5px;
			color: var(--igb-pink);
		}
		.active{
			position: fixed;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: 0px;
			width: 100vw;
			height: 100vh;
			border: none;
			display: block;
		}

		iframe{
			display: none;
		}

		button{
			position: fixed;
			top: 0px;
			left: 0px;
			margin: 50px;
			width: 100px;
			height: 100px;
			background: white;
			box-sizing: border-box;
		}

		ul{
		
			right: 0px;
			bottom: 0px;
			margin: auto;
			list-style-type: none;
			margin: auto;
			padding: 0px;
			display: block;
		}

		li{
			list-style-type: none;
			margin: 0px;
			padding: 0px;
			
			padding: 30px 40px;
			
			
			
			background: white;
			text-align: center;
			display: inline-block;
			margin: 5px;

			background: rgba(255, 255, 255, 0.1);
			color: var(--igb-pink);
			border: 2px solid var(--igb-pink);
		}

		menu{
			padding: 20% 5%;
			display: block;
			position: fixed;
			right: 0px;
			top: 0px;
			text-align: right;
		}

		tracker{
			position: absolute;
			top: 0px;
			left: 33.3%;
			right: 33.3%;
			bottom: 0px;
			border: 1px solid var(--igb-pink);
			overflow: hidden;
		}

		player{
			width: 100px;
			height: 100px;
			background: var(--igb-pink);
			border-radius: 100%;
			display: block;
			transform: translate(-50%, -50%);
		}
	</style>
</head>
<body>
	<tracker></tracker>
	<menu>
		<ul class="menu-function">
			<li btn='menu'>MENU</li>
		</ul>
		<ul class="menu-games">
			
		</ul>
		<logger>LOADING...</logger>
	</menu>

	<iframe src=""></iframe>
	
	
</body>
</html>